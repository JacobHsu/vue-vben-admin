import{ap as e,v as n,dU as o,e8 as t,e9 as s,as as a,y as l,ea as u}from"./index.74f7b770.js";const r=u?window:void 0;const c=["mousedown","touchstart","pointerdown"];function i(n,o,u={}){const{window:i=r}=u;if(!i)return;const v=e=>{const t=function(e){var n,o;const t=l(e);return null!==(o=null===(n=t)||void 0===n?void 0:n.$el)&&void 0!==o?o:t}(n);t&&(t===e.target||e.composedPath().includes(t)||o(e))};let d=c.map((n=>function(...n){let o,u,c,i;if(t(n[0])?([u,c,i]=n,o=r):[o,u,c,i]=n,!o)return s;let v=s;const d=a((()=>l(o)),(e=>{v(),e&&(e.addEventListener(u,c,i),v=()=>{e.removeEventListener(u,c,i),v=s})}),{immediate:!0,flush:"post"}),f=()=>{d(),v()};return e(f),f}(i,n,v,{passive:!0})));const f=()=>{d.forEach((e=>e())),d=[]};return e(f),f}var v,d;function f(e){return!0===e?{}:e}function p(t,s={}){const{onConnected:a,onDisconnected:l,onError:u,onMessage:r}=s,c=n(null),i=n("CONNECTING"),v=n();let d,p,m=!1,E=0,N=[];const h=(e,n)=>{v.value&&(m=!0,null==d||d(),v.value.close(e,n))},w=(e,n=!0)=>v.value&&"OPEN"===i.value?(O(),v.value.send(e),!0):(n&&N.push(e),!1),O=()=>{if(N.length&&v.value&&"OPEN"===i.value){for(const e of N)v.value.send(e);N=[]}},T=()=>{const e=new WebSocket(t);v.value=e,i.value="CONNECTING",m=!1,e.onopen=()=>{i.value="OPEN",null==a||a(e),null==p||p(),O()},e.onclose=n=>{if(i.value="CLOSED",v.value=void 0,null==l||l(e,n),!m&&s.autoReconnect){const{retries:e=-1,delay:n=1e3,onFailed:o}=f(s.autoReconnect);E+=1,e<0||E<e?setTimeout(T,n):null==o||o()}},e.onerror=n=>{null==u||u(e,n)},e.onmessage=n=>{c.value=n.data,null==r||r(e,n)}};if(s.heartbeat){const{message:e="ping",interval:n=1e3}=f(s.heartbeat),{pause:t,resume:a}=o((()=>w(e,!1)),n,!1);d=t,p=a}return e(h),{data:c,status:i,close:h,send:w,open:()=>{h(),E=0,T()},ws:v}}(d=v||(v={})).UP="UP",d.RIGHT="RIGHT",d.DOWN="DOWN",d.LEFT="LEFT";export{i as o,p as u};
