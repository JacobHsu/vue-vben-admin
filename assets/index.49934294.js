var e=Object.assign;import{e as a,s,w as t,an as l,k as r,dV as n,aP as o,r as i,o as d,m as u,F as c,n as m,G as p,p as f,H as v,au as g}from"./index.74f7b770.js";import{T as b}from"./index.04c03400.js";import{_ as x}from"./PageWrapper.3ff410f3.js";import{u as h}from"./index.esm.d2e02ed5.js";import"./vendor.62a151c9.js";import"./usePageContext.8eee5bf7.js";import"./index.b76b32b4.js";import"./index.a23a096e.js";import"./onMountedOrActivated.8ce13bba.js";import"./ArrowLeftOutlined.e7833055.js";var T=a({components:{PageWrapper:x,[s.name]:s,InputTextArea:s.TextArea,Tag:b},setup(){const a=t({server:"ws://localhost:3380/test",sendValue:"",recordList:[]}),{status:s,data:i,send:d,close:u,open:c}=h(a.server,{autoReconnect:!0,heartbeat:!0});l((()=>{if(i.value)try{const e=JSON.parse(i.value);a.recordList.push(e)}catch(e){a.recordList.push({res:i.value,id:Math.ceil(1e3*Math.random()),time:(new Date).getTime()})}}));const m=r((()=>"OPEN"===s.value)),p=r((()=>m.value?"success":"red")),f=r((()=>[...a.recordList].reverse()));return e(e({status:s,formatToDateTime:n},o(a)),{handlerSend:function(){d(a.sendValue),a.sendValue=""},getList:f,toggle:function(){m.value?u():c()},getIsOpen:m,getTagColor:p})}});const j={class:"flex"},y={class:"w-1/3 bg-white p-4"},w={class:"flex items-center"},O=m("span",{class:"text-lg font-medium mr-4"}," 连接状态: ",-1),k=m("hr",{class:"my-4"},null,-1),C={class:"flex"},I=p(" 服务地址 "),L=m("p",{class:"text-lg font-medium mt-4"},"设置",-1),P=m("hr",{class:"my-4"},null,-1),V=p(" 发送 "),_={class:"w-2/3 bg-white ml-4 p-4"},A=m("span",{class:"text-lg font-medium mr-4"}," 消息记录: ",-1),S=m("hr",{class:"my-4"},null,-1),W={class:"max-h-80 overflow-auto"},D={class:"flex items-center"},M=m("span",{class:"mr-2 text-primary font-medium"},"收到消息:",-1);T.render=function(e,a,s,t,l,r){const n=i("Tag"),o=i("a-input"),b=i("a-button"),x=i("InputTextArea"),h=i("PageWrapper");return d(),u(h,{title:"WebSocket 示例"},{default:c((()=>[m("div",j,[m("div",y,[m("div",w,[O,m(n,{color:e.getTagColor},{default:c((()=>[p(f(e.status),1)])),_:1},8,["color"])]),k,m("div",C,[m(o,{value:e.server,"onUpdate:value":a[1]||(a[1]=a=>e.server=a),disabled:""},{addonBefore:c((()=>[I])),_:1},8,["value"]),m(b,{type:e.getIsOpen?"danger":"primary",onClick:e.toggle},{default:c((()=>[p(f(e.getIsOpen?"关闭连接":"开启连接"),1)])),_:1},8,["type","onClick"])]),L,P,m(x,{placeholder:"需要发送到服务器的内容",disabled:!e.getIsOpen,value:e.sendValue,"onUpdate:value":a[2]||(a[2]=a=>e.sendValue=a),allowClear:""},null,8,["disabled","value"]),m(b,{type:"primary",block:"",class:"mt-4",disabled:!e.getIsOpen,onClick:e.handlerSend},{default:c((()=>[V])),_:1},8,["disabled","onClick"])]),m("div",_,[A,S,m("div",W,[m("ul",null,[(d(!0),u(v,null,g(e.getList,(a=>(d(),u("li",{class:"border-b-1 mt-2",key:a.time},[m("div",D,[M,m("span",null,f(e.formatToDateTime(a.time)),1)]),m("div",null,f(a.res),1)])))),128))])])])])])),_:1})};export default T;
