var e=Object.assign;import{aq as l,j as n,an as t,y as o,aY as a,e as s,aP as r,n as i,cZ as c,a9 as u,c_ as d,cI as p,b3 as f,b4 as g,bq as h,v as m,k as b,as as v,ak as C,c$ as F,R as H,r as k,bD as y,o as M,m as O,F as S,D as P,aw as w,bS as x,g as T,H as W,J as $,q as j,G as R,p as B,d0 as E,bp as A,cu as N,ar as _,ao as D,cX as I,at as L,au as V,w as q,d1 as X,A as Y,aj as z,cW as G,ap as J}from"./index.74f7b770.js";import{u as Z}from"./useWindowSizeFn.4c694b21.js";import{F as K,a as Q}from"./FullscreenOutlined.72f7c504.js";const{t:U}=n(),ee={visible:l.bool,scrollTop:l.bool.def(!0),height:l.number,minHeight:l.number,draggable:l.bool.def(!0),centered:l.bool,cancelText:l.string.def(U("common.cancelText")),okText:l.string.def(U("common.okText")),closeFunc:Function},le=Object.assign({},ee,{defaultFullscreen:l.bool,canFullscreen:l.bool.def(!0),wrapperFooterOffset:l.number.def(0),helpMessage:[String,Array],useWrapper:l.bool.def(!0),loading:l.bool,loadingTip:l.string,showCancelBtn:l.bool.def(!0),showOkBtn:l.bool.def(!0),wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:l.bool.def(!0),closeIcon:Object,confirmLoading:l.bool,destroyOnClose:l.bool,footer:Object,getContainer:Function,mask:l.bool.def(!0),maskClosable:l.bool.def(!0),keyboard:l.bool.def(!0),maskStyle:Object,okType:l.string.def("primary"),okButtonProps:Object,cancelButtonProps:Object,title:l.string,visible:l.bool,width:[String,Number],wrapClassName:l.string,zIndex:l.number});function ne(e){const l=(e,l)=>getComputedStyle(e)[l],n=n=>{if(!n)return;n.setAttribute("data-drag",o(e.draggable));const t=n.querySelector(".ant-modal-header"),a=n.querySelector(".ant-modal");t&&a&&o(e.draggable)&&(t.style.cursor="move",t.onmousedown=e=>{if(!e)return;const n=e.clientX,t=e.clientY,o=document.body.clientWidth,s=document.documentElement.clientHeight,r=a.offsetWidth,i=a.offsetHeight,c=a.offsetLeft,u=o-a.offsetLeft-r,d=a.offsetTop,p=s-a.offsetTop-i,f=l(a,"left"),g=l(a,"top");let h=+f,m=+g;f.includes("%")?(h=+document.body.clientWidth*(+f.replace(/%/g,"")/100),m=+document.body.clientHeight*(+g.replace(/%/g,"")/100)):(h=+f.replace(/px/g,""),m=+g.replace(/px/g,"")),document.onmousemove=function(e){let l=e.clientX-n,o=e.clientY-t;-l>c?l=-c:l>u&&(l=u),-o>d?o=-d:o>p&&(o=p),a.style.cssText+=`;left:${l+h}px;top:${o+m}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})};t((()=>{o(e.visible)&&o(e.draggable)&&a((()=>{(()=>{const t=document.querySelectorAll(".ant-modal-wrap");for(const a of Array.from(t)){if(!a)continue;const t=l(a,"display"),s=a.getAttribute("data-drag");"none"!==t&&(null===s||o(e.destroyOnClose))&&n(a)}})()}),30)}))}var te=s({name:"Modal",inheritAttrs:!1,props:le,setup(l,{slots:n}){const{visible:t,draggable:a,destroyOnClose:s}=r(l),f=p();return ne({visible:t,destroyOnClose:s,draggable:a}),()=>{let t;const a=e(e({},o(f)),l);return i(d,a,"function"==typeof(s=t=c(n))||"[object Object]"===Object.prototype.toString.call(s)&&!u(s)?t:{default:()=>[t]});var s}}});const oe=Symbol();function ae(){return g(oe)}var se=s({name:"ModalWrapper",components:{ScrollContainer:h},inheritAttrs:!1,props:{loading:l.bool,useWrapper:l.bool.def(!0),modalHeaderHeight:l.number.def(57),modalFooterHeight:l.number.def(74),minHeight:l.number.def(200),height:l.number,footerOffset:l.number.def(0),visible:l.bool,fullScreen:l.bool,loadingTip:l.string},emits:["height-change","ext-height"],setup(e,{emit:l}){const n=m(null),a=m(null),s=m(0),r=m(0);let i=0;Z(u.bind(null,!1)),f({redoModalHeight:u},oe);const c=b((()=>({minHeight:`${e.minHeight}px`,height:`${o(s)}px`})));async function u(){if(!e.visible)return;const t=o(n);if(!t)return;const r=t.$el.parentElement;if(r){r.style.padding="0",await H();try{const n=r.parentElement&&r.parentElement.parentElement;if(!n)return;const t=getComputedStyle(n).top,c=Number.parseInt(t);let u=window.innerHeight-2*c+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;c<40&&(u-=26),await H();const d=o(a);if(!d)return;await H(),i=d.scrollHeight,e.fullScreen?s.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:s.value=e.height?e.height:i>u?u:i,l("height-change",o(s))}catch(c){}}}return t((()=>{e.useWrapper&&u()})),v((()=>e.fullScreen),(e=>{u(),e?r.value=s.value:s.value=r.value})),C((()=>{const{modalHeaderHeight:n,modalFooterHeight:t}=e;l("ext-height",n+t)})),F((()=>{})),{wrapperRef:n,spinRef:a,spinStyle:c,scrollTop:async function(){H((()=>{var e;const l=o(n);l&&(null==(e=null==l?void 0:l.scrollTo)||e.call(l,0))}))},setModalHeight:u}}});se.render=function(e,l,n,t,o,a){const s=k("ScrollContainer"),r=y("loading");return M(),O(s,{ref:"wrapperRef"},{default:S((()=>[P(i("div",{ref:"spinRef",style:e.spinStyle,"loading-tip":e.loadingTip},[w(e.$slots,"default")],12,["loading-tip"]),[[r,e.loading]])])),_:3},512)};var re=s({name:"ModalClose",components:{FullscreenExitOutlined:K,FullscreenOutlined:Q,CloseOutlined:x},props:{canFullscreen:l.bool.def(!0),fullScreen:l.bool},emits:["cancel","fullscreen"],setup(e,{emit:l}){const{prefixCls:n}=T("basic-modal-close");return{getClass:b((()=>[n,`${n}--custom`,{[`${n}--can-full`]:e.canFullscreen}])),prefixCls:n,handleCancel:function(){l("cancel")},handleFullScreen:function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),l("fullscreen")}}}});re.render=function(e,l,n,t,o,a){const s=k("FullscreenExitOutlined"),r=k("FullscreenOutlined"),c=k("CloseOutlined");return M(),O("div",{class:e.getClass},[e.canFullscreen?(M(),O(W,{key:0},[e.fullScreen?(M(),O(s,{key:0,role:"full",onClick:e.handleFullScreen},null,8,["onClick"])):(M(),O(r,{key:1,role:"close",onClick:e.handleFullScreen},null,8,["onClick"]))],64)):$("",!0),i(c,{onClick:e.handleCancel},null,8,["onClick"])],2)};var ie=s({name:"BasicModalFooter",props:le,emits:["ok","cancel"],setup:(e,{emit:l})=>({handleOk:function(){l("ok")},handleCancel:function(){l("cancel")}})});ie.render=function(e,l,n,t,o,a){const s=k("a-button");return M(),O("div",null,[w(e.$slots,"insertFooter"),e.showCancelBtn?(M(),O(s,j({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:S((()=>[R(B(e.cancelText),1)])),_:1},16,["onClick"])):$("",!0),w(e.$slots,"centerFooter"),e.showOkBtn?(M(),O(s,j({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:S((()=>[R(B(e.okText),1)])),_:1},16,["type","onClick","loading"])):$("",!0),w(e.$slots,"appendFooter")])};var ce=s({name:"BasicModalHeader",components:{BasicTitle:E},props:{helpMessage:{type:[String,Array]},title:l.string}});ce.render=function(e,l,n,t,o,a){const s=k("BasicTitle");return M(),O(s,{helpMessage:e.helpMessage},{default:S((()=>[R(B(e.title),1)])),_:1},8,["helpMessage"])};var ue=s({name:"BasicModal",components:{Modal:te,ModalWrapper:se,ModalClose:re,ModalFooter:ie,ModalHeader:ce},inheritAttrs:!1,props:le,emits:["visible-change","height-change","cancel","ok","register"],setup(l,{emit:n,attrs:a}){const s=m(!1),r=m(null),i=m(null),c=m(0),u={setModalProps:function(e){if(r.value=I(o(r)||{},e),!Reflect.has(e,"visible"))return;s.value=!!e.visible},emitVisible:void 0,redoModalHeight:()=>{H((()=>{o(i)&&o(i).setModalHeight()}))}},d=D();d&&n("register",u,d.uid);const p=b((()=>e(e({},l),o(r)))),{handleFullScreen:f,getWrapClassName:g,fullScreenRef:h}=function(e){const l=m(!1);return{getWrapClassName:b((()=>{const n=o(e.wrapClassName)||"";return o(l)?`fullscreen-modal ${n} `:o(n)})),handleFullScreen:function(e){e&&e.stopPropagation(),l.value=!o(l)},fullScreenRef:l}}({modalWrapperRef:i,extHeightRef:c,wrapClassName:A(p.value,"wrapClassName")}),C=b((()=>{const l=e(e({},o(p)),{visible:o(s),title:void 0});return e(e({},l),{wrapClassName:o(g)})})),F=b((()=>{const l=e(e({},a),o(C));return o(h)?N(l,"height"):l})),k=b((()=>{if(!o(h))return o(C).height}));return t((()=>{s.value=!!l.visible,h.value=!!l.defaultFullscreen})),v((()=>o(s)),(e=>{var t;n("visible-change",e),d&&(null==(t=u.emitVisible)||t.call(u,e,d.uid)),H((()=>{l.scrollTop&&e&&o(i)&&o(i).scrollTop()}))}),{immediate:!1}),{handleCancel:async function(e){if(null==e||e.stopPropagation(),l.closeFunc&&_(l.closeFunc)){const e=await l.closeFunc();s.value=!e}else s.value=!1,n("cancel")},getBindValue:F,getProps:C,handleFullScreen:f,fullScreenRef:h,getMergeProps:p,handleOk:function(){n("ok")},visibleRef:s,omit:N,modalWrapperRef:i,handleExtHeight:function(e){c.value=e},handleHeightChange:function(e){n("height-change",e)},handleTitleDbClick:function(e){l.canFullscreen&&(e.stopPropagation(),f(e))},getWrapperHeight:k}}});ue.render=function(e,l,n,t,o,a){const s=k("ModalClose"),r=k("ModalHeader"),c=k("ModalFooter"),u=k("ModalWrapper"),d=k("Modal");return M(),O(d,j({onCancel:e.handleCancel},e.getBindValue),L({default:S((()=>[i(u,j({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:void 0===e.footer||e.footer?void 0:0},e.omit(e.getProps.wrapperProps,"visible","height"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:S((()=>[w(e.$slots,"default")])),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])])),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:S((()=>[i(s,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])]))},e.$slots.title?void 0:{name:"title",fn:S((()=>[i(r,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])]))},e.$slots.footer?void 0:{name:"footer",fn:S((()=>[i(c,j(e.getProps,{onOk:e.handleOk,onCancel:e.handleCancel}),L({_:2},[V(Object.keys(e.$slots),(l=>({name:l,fn:S((n=>[w(e.$slots,l,n)]))})))]),1040,["onOk","onCancel"])]))},V(Object.keys(e.omit(e.$slots,"default")),(l=>({name:l,fn:S((n=>[w(e.$slots,l,n)]))})))]),1040,["onCancel"])};const de=q({}),pe=q({});function fe(){const e=m(null),l=m(!1),n=m("");const t=()=>{const l=o(e);return l||G("useModal instance is undefined!"),l};return[function(t,a){n.value=a,F((()=>{e.value=null,l.value=!1,de[o(n)]=null})),o(l)&&X()&&t===o(e)||(e.value=t,t.emitVisible=(e,l)=>{pe[l]=e})},{setModalProps:e=>{var l;null==(l=t())||l.setModalProps(e)},getVisible:b((()=>pe[~~o(n)])),redoModalHeight:()=>{var e,l;null==(l=null==(e=t())?void 0:e.redoModalHeight)||l.call(e)},openModal:(e=!0,l,a=!0)=>{var s;if(null==(s=t())||s.setModalProps({visible:e}),!l)return;if(a)return de[o(n)]=null,void(de[o(n)]=Y(l));z(Y(de[o(n)]),Y(l))||(de[o(n)]=Y(l))}}]}const ge=e=>{const l=m(null),n=D(),a=m(""),s=()=>{const e=o(l);return e||G("useModalInner instance is undefined!"),e};return t((()=>{const l=de[o(a)];l&&e&&_(e)&&H((()=>{e(l)}))})),[(e,t)=>{J((()=>{l.value=null})),a.value=t,l.value=e,null==n||n.emit("register",e,t)},{changeLoading:(e=!0)=>{var l;null==(l=s())||l.setModalProps({loading:e})},getVisible:b((()=>pe[~~o(a)])),changeOkLoading:(e=!0)=>{var l;null==(l=s())||l.setModalProps({confirmLoading:e})},closeModal:()=>{var e;null==(e=s())||e.setModalProps({visible:!1})},setModalProps:e=>{var l;null==(l=s())||l.setModalProps(e)}}]};export{ue as _,ge as a,fe as b,ae as u};
